# Copyright (C) 2009 Dejan Muhamedagic
# Copyright (C) 2015 Kristoffer Gronlund
#
# License: GNU General Public License (GPL)
---
- version: 2.2
  shortdesc: Shared storage based fencing
  longdesc: >
    This template generates a single instance of external/sbd.

    There is quite a bit more to do to make this stonith operational.
    See http://www.linux-ha.org/wiki/SBD_Fencing for information.
  parameters:
    - name: id
      shortdesc: The resource id (name)
      example: stonith-sbd
      required: true
      type: resource-id
    - name: sbd_device
      shortdesc: Name of the device (shared disk)
      longdesc: >
        NB: Make sure that the device remains the same on reboots. It's
        preferable to use udev generated names rather than the usual
        /dev/sd?
      type: device
      required: true
  actions:
    - cib: |
        primitive {{id}} stonith:external/sbd
          params sbd_device="{{sbd_device}}"
          op monitor interval=15s timeout=60s
          op start timeout=60s
