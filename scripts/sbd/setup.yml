---
- name: Install and configure SBD
  description:
    If you have shared storage, for example a SAN or iSCSI target,
    you can use it to avoid split-brain scenarios by configuring SBD.
    This requires a 1 MB partition, accessible to all nodes in the
    cluster. The device path must be persistent and consistent
    across all nodes in the cluster, so /dev/disk/by-id/* devices
    are a good choice. Note that all data on the partition you
    specify here will be destroyed.

    This script installs required packages and applies a basic 
    configuration for SBD.
  parameters:
    - name: sbd_device
      required: true
      description:
        Block device used by SBD.
    - name: sbd_options
      default: "-W"
      description:
        Options passed to the SBD process.

  steps:
    - name: Ensure SBD packages are installed
      package: name=sbd state=present

    - name: Configure SBD
      template: src=files/sbd.j2 dest=/etc/sysconfig/sbd
