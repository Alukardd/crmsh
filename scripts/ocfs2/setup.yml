---
- name: Install and configure the OCFS2 file system
  description: >
    OCFS2 is a general-purpose shared-disk cluster file system for Linux
    capable of providing both high performance and high availability. As
    it provides local file system semantics, it can be used with almost
    all applications. Cluster-aware applications can make use of
    cache-coherent parallel I/Os from multiple nodes to scale out
    applications easily. Other applications can make use of the file
    system facilities to fail-over running application in the event of a
    node failure.

    This script ensures that OCFS2 is installed and configured on all
    cluster nodes.
  parameters:
    - name: max_nodes
      default: 32
    - name: device
      required: true
  
  steps:
    - name: Install OCFS2 tools
      package: name=ocfs2-tools state=present

    - name: Create OCFS2 file system
      command: mkfs.ocfs2 -N %(max_nodes)s %(device)s
      where: local
